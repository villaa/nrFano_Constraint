<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="my_style.css" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Electron Recoil Band Distribution</title>
  <<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async>
  </script>
>

</head>
<body>
<p>
  <H1>Electron Recoil Band Distribution</H1>
  <H2>Theory</H2>
 In the current model, the yield for the electron recoil band is being 
 calculated assuming that the measureed charge energy \(E_{q_m}\) and phonon energy \(E_{p_m}\) are independent.
To do so, we  randomly draw from a distribution of known recoil energies \(E_{er}\). Using \(E_{er}\), the true phonon energy, \(E_p\), is calculated:


$$E_p = E_{er} + VN_{eh}$$

$$N_{eh} = \frac{E_{er}}{\epsilon}$$

Where \(N_{eh}\) is the average number of electron hole pairs produced, V is the applied detetcor voltage, and \(\epsilon\) is the amount of energy needed to 
liberate 1 electron hole pair. 
 <br />

The meausred charge \(E_{q_m}\) and phonon energy \(E_{p_m}\) are calculated by drawing from normal distributions formed using \(E_p\) and \(E_{er}\) and detector 
resolutions from CDMS:  \(\sigma_p\) and \(\sigma_q\). 

$$E_{p_{m}} = random.normal(E_p,\sigma_p)$$
$$E_{q_{m}} = random.normal(E_{er},\sigma_q)$$

These are then used to calculate the measured recoil energy: 

$$Er_{m} = E_{p_m} - \frac{E_{q_m}V}{\epsilon} $$
 <br />

With that, we can calculated the yield:

$$Y = \frac{E_{q_m}}{Er_m}$$

<H2>Expected Distribution (CDMS)</H2>
When fitting the data from CDMS, the collaboration assumed that the distribution for electron recoils is normally distributed:


  <figure>
  <div class="row">
  <div class="column">
      <img src="figures/CDMS_bandfit.png" style="width:90%">
    </div>
    <div class="column">
      <img src="figures/CDMS_fit.png" style="width:90%">
    </div>
  </div>
  <p align ="center" >
    <figcaption>
    Figure 1: Plots from High Threshold Analysis Note 303. Plot on right: 1,2,3 \(\sigma\) band fits to electron recoil band. Left Plot: Gaussain fit to 
    yield for electron recoils of 24.5-33.1keV. 
    </figcaption>
  </p>
  </figure>
</p>



The  1, 2 and 3\(\sigma\) bands that CDMS use are generated under this assumption. However, if we look at the containment fractions for the 
\(1\sigma\) CDMS bands for simulated data, we see that the assumption of normality isn't correct:
  
<figure>
    <img src="figures/ER_containment1.png"  style="width:90%" >
    <figcaption>
    Table1: 1\(\sigma\) containment fractions for simulated electron recoil data. 
</figure>


Looking at the amount of data in each energy bin,"Percent in band" we can see that the amount of data is to high. If the yield in each bin were normally distributed,
we would expect to see \(68\%\). The distribution in each bin is also postivly skewed. This can been see by the "percent from high" and "percent from low"
catagories. 

<H2>Expected Probability Distribution (Ratio of Gaussians)</H2>

As mentioned, CDMS assumes that the distribution for the electron recoil band is normally distributed. As shown above, we can see that this not the case. 
It turns out that the distribution for the ratio of two normally distributed independent random variables with non-idential non-zero means is not a normal distribution.
As a reminder, the Yield for the electron recoil band is: 

$$ Y = \frac{E_{q_m}}{Er_m} = \frac{E_{q_m}}{E_{p_m} - \frac{E_{q_m}V}{\epsilon}} $$

It tuns out that the pdf for the yield is quite complicated. If we let \(x = E_q\) and \(y = E_p-kE_q\), then our variable of interest is \(z = \frac{x}{y}\).
To find \(z\), we first need the joint probability distribution for \(x\) and \(y\):

$$X_{pdf}(x) = \frac{1}{\delta_x\sqrt{2\pi}}e^{-\frac{(x-\mu_x)^2}{2(\delta_x)^2}} 
\\
Y_{pdf}(y) = \frac{1}{\sqrt{(\delta_p^2+\delta_x^2)2\pi}}e^{-\frac{(y-(\mu_p-k\mu_x))^2}{2(\delta_p^2+\delta_x^2)}} 
$$

Here, \(\delta_x\) and \(\delta_p\) are the sample standard deviations, and \(\mu_x\) and \(\mu_p\) are the sample means, for \(x\) and \(y\) respectivly. 
<br />
The joint pdf for \(x\) and \(y\) is:

$$ XY_{pdf} = \frac{1}{2\pi\delta_p\delta_x}e^{-(\frac{(x-\mu_x)^2}{2\delta_x^2} + \frac{(y-(\mu_p-k\mu_x))^2}{2\delta_p^2})}  $$

The pdf for \(z\) is: 

$$ Z_{pdf}(z) = \int_{-\infty}^{\infty}|t|XY_{pdf}(zt,t)dt $$

$$ XY_{pdf} = \frac{1}{2\pi\delta_p\delta_x} e^{-c(x,y)} \rightarrow Z_{pdf}(z) = \frac{1}{2\pi\delta_p\delta_x}\int_{-\infty}^{\infty}|t|e^{-c(zt,t)}dt  $$
(NEED TO TALK TO ARVIND ABOUT TRANSFORMATIOn)

<br/>
The details of evaluating the integral for \(Z_{pdf}(z)\) can be found in Arvind's note. see: (). The soultion for \(Z_{pdf}(z)\) is:

$$ P_z(z,\mu_p,\mu_x,\delta_p,\delta_x) = Ae^{\frac{1}{2}((\frac{\mu_x}{\delta_x})^2 + (\frac{\mu_p}{\delta_p})^2)} + Be^{C} +Erf(D)$$

$$ A = \frac{1}{\pi(z^2(\frac{\delta_p}{\delta_x})+(1+kz)^2(\frac{\delta_p}{\delta_x}))}$$

$$ B = \frac{\frac{\delta_p}{\delta_x}(z\frac{\mu_x}{\delta_x}\frac{\delta_p}{\delta_x} + (1+kz)\frac{\mu_p}{\delta_p})}{\sqrt{2\pi}(z^2(\frac{\delta_p}{\delta_x})^2+(1+kz)^2(\frac{\delta_p}{\delta_x}))^\frac{3}{2}}$$
 
$$ C = \frac{(z\frac{\mu_p}{\delta_p}\frac{\delta_p}{\delta_x}-(1+kz)\frac{\mu_x}{\delta_x})^2}{z(z^2(\frac{\delta_p}{\delta_x})^2 + (1+kz)^2)}    $$


$$ D = \frac{z\frac{\mu_x}{\delta_x} + (1+kz)\frac{\mu_p}{\delta_p}\frac{\delta_x}{\delta_p}}{\sqrt{2(z^2 + (1+kz)^2(\frac{\delta_x}{\delta_p})^2)}}     $$









<h3>Expected Distribution</h3>

<div class="tab">
  <button class="tablinks" onclick="openPlot(event, '1')">1</button>
  <button class="tablinks" onclick="openPlot(event, '2')">2</button>
  <button class="tablinks" onclick="openPlot(event, '3')">3</button>
  <button class="tablinks" onclick="openPlot(event, '4')">4</button>
  <button class="tablinks" onclick="openPlot(event, '5')">5</button>
  <button class="tablinks" onclick="openPlot(event, '6')">6</button>
  <button class="tablinks" onclick="openPlot(event, '7')">7</button>
  <button class="tablinks" onclick="openPlot(event, '8')">8</button>
  <button class="tablinks" onclick="openPlot(event, '9')">9</button>
</div>

<div id="1" class="tabcontent">
  <h3>10-13.4 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/11.70.png " width = "500" height = "400" >
  </p>
</div>

<div id="2" class="tabcontent">
  <h3>13.4-18.1 keV</h3>
  <p align ="center">
    <img src="figures/Dist_fits/15.75.png" width = "500" height = "400" >
  </p>
</div>

<div id="3" class="tabcontent">
  <h3>18.1-24.5 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/21.30.png" width = "500" height = "400" >
  </p>
</div>

<div id="4" class="tabcontent">
  <h3>24.5-33.1 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/28.80.png" width = "500" height = "400" >
  </p>
</div>

<div id="5" class="tabcontent">
  <h3>33.1-44.8 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/38.95.png" width = "500" height = "400" >
  </p>
</div>

<div id="6" class="tabcontent">
  <h3>44.8-55.0 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/49.90.png" width = "500" height = "400" >
  </p>
</div>

<div id="7" class="tabcontent">
  <h3>55.0-60.6 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/57.80.png" width = "500" height = "400" >
  </p>
</div>

<div id="8" class="tabcontent">
  <h3>60.6-80.2 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/70.40.png" width = "500" height = "400" >
  </p>
</div>

<div id="9" class="tabcontent">
  <h3>80.2-110.0 keV</h3>
  <p align ="center" >
    <img src="figures/Dist_fits/95.10.png" width = "500" height = "400" >
  </p>
</div>





<script>
function openPlot(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>




</p>
</body>
</html>